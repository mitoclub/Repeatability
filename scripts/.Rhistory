RetrieveAllRepeatsCoveringGivenPositionAndNucleotideInSequence(mtDNA_seq,16223,"A",output_folder) # other parameters keep by default
RetrieveAllRepeatsCoveringGivenPositionAndNucleotideInSequence(mtDNA_seq,16223,"G",output_folder) # other parameters keep by default
RetrieveAllRepeatsCoveringGivenPositionAndNucleotideInSequence(mtDNA_seq,16223,"C",output_folder) # other parameters keep by default
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
library(knitr)
library(tidyverse)
library(kableExtra)
library(dplyr)
library(tidyr)
library(ggplot2)
library(Biostrings)
library(stringdist) # install.packages("stringdist")
library(IRanges)
rep = read.table("../data/2_derived/01KP/01KP.8473.T.txt")
View(rep)
rep = read.table("../data/2_derived/01KP/01KP.8473.T.txt", header = TRUE)
View(rep)
major_arc_start <- 5798
major_arc_end <- 16568
rep = read.table("../data/2_derived/01KP/01KP.8473.T.txt", header = TRUE)
head(rep)
names(rep)
### Apply filters
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &      # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &    # repeat in major arc
(rep$repeat.hamming.distance == 0),                                          # perfect similarity
]
# Sort by length (choose motif.length or effective.length)
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep)
major_arc_start <- 5798
major_arc_end <- 16568
rep = read.table("../data/2_derived/01KP/01KP.8473.T.txt", header = TRUE)
names(rep)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end),                      # pos strictly inside motif
]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep)
View(filtered_rep[1])
View(filtered_rep[1,])
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge <- function(pos, nuc) {
# Define major arc boundaries
major_arc_start <- 5798
major_arc_end <- 16568
# Construct file path
file_path <- paste0("../data/2_derived/01KP/01KP.", pos, ".", nuc, ".txt")
# Read the file
rep <- read.table(file_path, header = TRUE)
# Apply filters
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end),                      # pos strictly inside motif
]
# Sort by effective.length (descending)
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
# Return motif.length of the first row (if any)
if (nrow(filtered_rep) > 0) {
return(filtered_rep$motif.length[1])
} else {
return(NA)  # or return 0, or any default value if no rows match
}
}
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8473,'T')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8473,'C')
major_arc_start <- 5798
major_arc_end <- 16568
rep = read.table("../data/2_derived/01KP/01KP.8473.T.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end),                      # pos strictly inside motif
]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
rep = read.table("../data/2_derived/01KP/01KP.8473.C.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end),                      # pos strictly inside motif
]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge <- function(pos, nuc) {
# Define major arc boundaries
major_arc_start <- 5798
major_arc_end <- 16568
# Construct file path
file_path <- paste0("../data/2_derived/01KP/01KP.", pos, ".", nuc, ".txt")
# Read the file
rep <- read.table(file_path, header = TRUE)
# Apply filters
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end),                      # pos strictly inside motif
]
# Sort by effective.length (descending)
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
# Return motif.length of the first row (if any)
if (nrow(filtered_rep) > 0) {
return(filtered_rep$motif.length[1])
} else {
return(NA)  # or return 0, or any default value if no rows match
}
}
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8473,'T')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8473,'C')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8472,'C')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8472,'T')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8251,'G')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8251,'A')
rep = read.table("../data/2_derived/01KP/01KP.8251.G.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end),                      # pos strictly inside motif
]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
View(filtered_rep)
rep = read.table("../data/2_derived/01KP/01KP.8251.A.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end),                      # pos strictly inside motif
]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
View(filtered_rep)
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(12705,'C')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(12705,'T')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(14798,'T')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(14798,'C')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(16223,'C')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(16223,'T')
## 12705C>T
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(12705,'C')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(12705,'T')
## 8473T>C
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8473,'T')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8473,'C')
## 8472C>T
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8472,'C')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8472,'T')
## 8251G>A
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8251,'G')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8251,'A')
rep = read.table("../data/2_derived/01KP/01KP.8251.G.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end),                      # pos strictly inside motif
]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
View(filtered_rep)
rep = read.table("../data/2_derived/01KP/01KP.8251.A.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end),                      # pos strictly inside motif
]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
View(filtered_rep)
rep = read.table("../data/2_derived/01KP/01KP.14798.T.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end),                      # pos strictly inside motif
]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
View(filtered_rep)
rep = read.table("../data/2_derived/01KP/01KP.14798.C.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end),                      # pos strictly inside motif
]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
View(filtered_rep)
rep = read.table("../data/2_derived/01KP/01KP.14798.T.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0)                                         # perfect similarity
#& (rep$motif.start < rep$pos & rep$pos < rep$motif.end)                      # pos strictly inside motif
,]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
View(filtered_rep)
rep = read.table("../data/2_derived/01KP/01KP.14798.C.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0)                                         # perfect similarity
# & (rep$motif.start < rep$pos & rep$pos < rep$motif.end)                      # pos strictly inside motif
,]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
View(filtered_rep)
rep = read.table("../data/2_derived/01KP/01KP.14798.T.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0)                                         # perfect similarity
#& (rep$motif.start < rep$pos & rep$pos < rep$motif.end)                      # pos strictly inside motif
,]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
View(filtered_rep)
rep = read.table("../data/2_derived/01KP/01KP.14798.T.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0)                                         # perfect similarity
#& (rep$motif.start < rep$pos & rep$pos < rep$motif.end)                      # pos strictly inside motif
,]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
View(filtered_rep)
rep = read.table("../data/2_derived/01KP/01KP.14798.C.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0)                                         # perfect similarity
# & (rep$motif.start < rep$pos & rep$pos < rep$motif.end)                      # pos strictly inside motif
,]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
View(filtered_rep)
rep = read.table("../data/2_derived/01KP/01KP.14798.T.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0)                                         # perfect similarity
#& (rep$motif.start < rep$pos & rep$pos < rep$motif.end)                      # pos strictly inside motif
,]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
View(filtered_rep)
rep = read.table("../data/2_derived/01KP/01KP.14798.T.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end)   # repeat in major arc
# & (rep$repeat.hamming.distance == 0)                                         # perfect similarity
#& (rep$motif.start < rep$pos & rep$pos < rep$motif.end)                      # pos strictly inside motif
,]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
View(filtered_rep)
rep = read.table("../data/2_derived/01KP/01KP.14798.C.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end)    # repeat in major arc
# & (rep$repeat.hamming.distance == 0)                                         # perfect similarity
# & (rep$motif.start < rep$pos & rep$pos < rep$motif.end)                      # pos strictly inside motif
,]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
View(filtered_rep)
RepeatabilityDegradedLongestInsideMajprArcPosNotAtTheEdge <- function(pos, nuc) {
# Define major arc boundaries
major_arc_start <- 5798
major_arc_end <- 16568
# Construct file path
file_path <- paste0("../data/2_derived/01KP/01KP.", pos, ".", nuc, ".txt")
# Read the file
rep <- read.table(file_path, header = TRUE)
# Apply filters
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
#(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
& (rep$motif.start < rep$pos & rep$pos < rep$motif.end),                      # pos strictly inside motif
RepeatabilityDegradedLongestInsideMajprArcPosNotAtTheEdge <- function(pos, nuc) {
# Define major arc boundaries
major_arc_start <- 5798
major_arc_end <- 16568
# Construct file path
file_path <- paste0("../data/2_derived/01KP/01KP.", pos, ".", nuc, ".txt")
# Read the file
rep <- read.table(file_path, header = TRUE)
# Apply filters
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
#(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end),                      # pos strictly inside motif
]
# Sort by effective.length (descending)
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
# Return motif.length of the first row (if any)
if (nrow(filtered_rep) > 0) {
return(filtered_rep$motif.length[1])
} else {
return(NA)  # or return 0, or any default value if no rows match
}
}
RepeatabilityDegradedLongestInsideMajprArcPosNotAtTheEdge(8251,'G')
RepeatabilityDegradedLongestInsideMajprArcPosNotAtTheEdge(8251,'A')
Repeatability10DegradedLongestInsideMajorArcPosNotAtTheEdge <- function(pos, nuc) {
# Define major arc boundaries
major_arc_start <- 5798
major_arc_end <- 16568
# Construct file path
file_path <- paste0("../data/2_derived/01KP/01KP.", pos, ".", nuc, ".txt")
# Read the file
rep <- read.table(file_path, header = TRUE)
# Calculate degradation percentage
rep$degradation <- (rep$motif.length - rep$effective.length) / rep$motif.length * 100
# Apply filters
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end) &                     # pos strictly inside motif
(rep$degradation <= 10),                                                    # degradation <= 10%
]
# Sort by effective.length (descending)
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
# Return motif.length of the first row (if any)
if (nrow(filtered_rep) > 0) {
return(filtered_rep$motif.length[1])
} else {
return(NA)  # or return 0, or any default value if no rows match
}
}
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8251,'G')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8251,'A')
Repeatability10DegradedLongestInsideMajprArcPosNotAtTheEdge(8251,'G')
Repeatability10DegradedLongestInsideMajorArcPosNotAtTheEdge <- function(pos, nuc) {
# Define major arc boundaries
major_arc_start <- 5798
major_arc_end <- 16568
# Construct file path
file_path <- paste0("../data/2_derived/01KP/01KP.", pos, ".", nuc, ".txt")
# Read the file
rep <- read.table(file_path, header = TRUE)
# Calculate degradation percentage
rep$degradation <- (rep$motif.length - rep$effective.length) / rep$motif.length * 100
# Apply filters
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end) &                     # pos strictly inside motif
(rep$degradation <= 10),                                                    # degradation <= 10%
]
# Sort by effective.length (descending)
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
# Return motif.length of the first row (if any)
if (nrow(filtered_rep) > 0) {
return(filtered_rep$motif.length[1])
} else {
return(NA)  # or return 0, or any default value if no rows match
}
}
Repeatability10DegradedLongestInsideMajorArcPosNotAtTheEdge(8251,'G')
Repeatability10DegradedLongestInsideMajorArcPosNotAtTheEdge(8251,'A')
Repeatability10DegradedLongestInsideMajorArcPosNotAtTheEdge <- function(pos, nuc) {
# Define major arc boundaries
major_arc_start <- 5798
major_arc_end <- 16568
# Construct file path
file_path <- paste0("../data/2_derived/01KP/01KP.", pos, ".", nuc, ".txt")
# Read the file
rep <- read.table(file_path, header = TRUE)
# Calculate degradation percentage
rep$degradation <- ((rep$motif.length - rep$effective.length) / rep$motif.length) * 100
# Apply filters
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$motif.start < rep$pos & rep$pos < rep$motif.end) &                     # pos strictly inside motif
(rep$degradation <= 10),                                                    # degradation <= 10%
]
# Sort by effective.length (descending)
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
# Return motif.length of the first row (if any)
if (nrow(filtered_rep) > 0) {
return(filtered_rep$motif.length[1])
} else {
return(NA)  # or return 0, or any default value if no rows match
}
}
Repeatability10DegradedLongestInsideMajorArcPosNotAtTheEdge(8251,'G')
Repeatability10DegradedLongestInsideMajorArcPosNotAtTheEdge(8251,'A')
Repeatability10DegradedLongestInsideMajorArcPosNotAtTheEdge(8251,'G')
Repeatability10DegradedLongestInsideMajorArcPosNotAtTheEdge(8251,'A')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8473,'T')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(8473,'C')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(14798,'T')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(14798,'C')
RepeatabilityPerfectLongestInsideMajprArcPosNotAtTheEdge(14798,'T')
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
library(knitr)
library(tidyverse)
library(kableExtra)
library(dplyr)
library(tidyr)
library(ggplot2)
library(Biostrings)
library(stringdist) # install.packages("stringdist")
library(IRanges)
major_arc_start <- 5798
major_arc_end <- 16568
rep = read.table("../data/2_derived/01KP/01KP.8473.T.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end),                      # pos strictly inside motif
]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
rep = read.table("../data/2_derived/01KP/01KP.8473.C.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end),                      # pos strictly inside motif
]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
rep = read.table("../data/2_derived/01KP/01KP.8251.G.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end),                      # pos strictly inside motif
]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
rep = read.table("../data/2_derived/01KP/01KP.8251.A.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end) &   # repeat in major arc
(rep$repeat.hamming.distance == 0) &                                        # perfect similarity
(rep$motif.start < rep$pos & rep$pos < rep$motif.end),                      # pos strictly inside motif
]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,])
rep = read.table("../data/2_derived/01KP/01KP.14798.T.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end)   # repeat in major arc
# & (rep$repeat.hamming.distance == 0)                                         # perfect similarity
#& (rep$motif.start < rep$pos & rep$pos < rep$motif.end)                      # pos strictly inside motif
,]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,]) # 13
rep = read.table("../data/2_derived/01KP/01KP.14798.C.txt", header = TRUE)
filtered_rep <- rep[
!(rep$motif.start == rep$repeat.start & rep$motif.end == rep$repeat.end) &  # motif != repeat
(rep$motif.start >= major_arc_start & rep$motif.end <= major_arc_end) &     # motif in major arc
(rep$repeat.start >= major_arc_start & rep$repeat.end <= major_arc_end)    # repeat in major arc
# & (rep$repeat.hamming.distance == 0)                                         # perfect similarity
# & (rep$motif.start < rep$pos & rep$pos < rep$motif.end)                      # pos strictly inside motif
,]
filtered_rep <- filtered_rep[order(filtered_rep$effective.length, decreasing = TRUE), ]
View(filtered_rep[1,]) # 17
